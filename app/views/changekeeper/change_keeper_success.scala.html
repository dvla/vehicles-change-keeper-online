@(viewModel: models.ChangeKeeperCompletionViewModel, surveyUrl: Option[String])(implicit lang: Lang,
    token: uk.gov.dvla.vehicles.presentation.common.filters.CsrfPreventionAction.CsrfPreventionToken,
    config: utils.helpers.Config)

@import scala.collection.mutable.LinkedHashMap
@import uk.gov.dvla.vehicles.presentation.common
@import views.html.helper.form
@import views.changekeeper.ChangeKeeperSuccess.FinishId
@import common.views.html.widgets.alertWarning
@import common.views.html.widgets.alertSuccess
@import common.views.html.widgets.base.csrfTokenHiddenField
@import common.views.html.widgets.playbackList

@main(
    progress = Some(Messages("change_keeper_progress_6")),
    title = "Summary"
){
<div class="two-col clearfix acquire-success">

    <div class="second-col">

        @alertSuccess(Some(Messages("change_keeper_success.complete.header"))){
            <p>@Messages("change_keeper_success.complete.p1")</p>
            @alertWarning() {
                <p><strong>@Messages("change_keeper_success.complete.p2")</strong></p>
            }
        }

        <h2>@Messages("change_keeper_success.further_information.header")</h2>

        <ul>
            <li>@Messages("change_keeper_success.further_information.p1")</li>
            <li>@Messages("change_keeper_success.further_information.p2")</li>
            <li>@Messages("change_keeper_success.further_information.p3")</li>
            <li>@Messages("change_keeper_success.further_information.p4")</li>
            <li>@Messages("change_keeper_success.further_information.p5")</li>
        </ul>

        <h2>@Messages("change_keeper_success.further_information.header.2")</h2>

        <ul>
            <li>@Messages("change_keeper_success.further_information.p6")</li>
            <li>@Messages("change_keeper_success.further_information.p7")</li>
            <li>@Messages("change_keeper_success.further_information.p8")</li>
        </ul>
    </div>

    <div class="first-col">
        @playbackList(
            Messages("change_keeper_success.transaction_details.header"),
            {
                val playbackItems: LinkedHashMap[String, String] = LinkedHashMap();
                playbackItems += (Messages("change_keeper_success.transaction_details.transaction_id") -> viewModel.completeAndConfirmResponseModel.transactionId)
                playbackItems += (Messages("change_keeper_success.transaction_details.transaction_date") -> viewModel.completeAndConfirmResponseModel.transactionTimestamp.toString("dd/MM/yyyy"))
            },
            List("transaction-details")
        )()

        <div class="related vehicle-sold-by desktop-only">
        </div>
        <div class="change-keeper-summary-playback">
            <h2>@Messages("change_keeper_success.vehicle_details.p1")</h2>

            <div class="info-notice">
                <dl class="playback">
                    <dt>@Messages("change_keeper_success.vehicle_details.registration_number")</dt>
                    <dd>@viewModel.vehicleAndKeeperDetails.registrationNumber</dd>
                    <dt>@Messages("change_keeper_success.vehicle_details.make")</dt>
                    <dd>@viewModel.vehicleAndKeeperDetails.make</dd>
                    <dt>@Messages("change_keeper_success.vehicle_details.model")</dt>
                    <dd>@viewModel.vehicleAndKeeperDetails.model</dd>
                    <dt>@Messages("change_keeper_success.vehicle_details.mileage")</dt>
                    @if(viewModel.dateOfSaleViewModel.mileage == None) {
                    <dd>@Messages("change_keeper_success.vehicle_details.mileage_not_entered")</dd>
                    } else {
                    <dd>@{java.text.NumberFormat.getIntegerInstance().format(viewModel.dateOfSaleViewModel.mileage.get)}</dd>
                    }
                </dl>
            </div>

            <h2>@Messages("change_keeper_success.new_keeper_details.p1")</h2>

            <div class="info-notice">
                <dl class="playback">
                    <dt>@Messages("change_keeper_success.vehicle_details.name")</dt>
                    <dd>@viewModel.newKeeperDetails.displayName</dd>
                    <dt>@Messages("change_keeper_success.vehicle_details.address")</dt>
                    <dd>@for(addr <- viewModel.newKeeperDetails.address.address) {@addr<br/>}</dd>
                    <dt>@Messages("change_keeper_success.vehicle_details.email")</dt>
                    @if(viewModel.newKeeperDetails.email == None) {
                    <dd>@Messages("change_keeper_email_not_entered")</dd>
                    } else {
                    <dd><span class="lowercase-text">@viewModel.newKeeperDetails.email.get</span></dd>
                    }
                    <dt>@Messages("change_keeper_success.date_of_sale.label")</dt>
                    <dd>@viewModel.dateOfSaleViewModel.dateOfSale.toString("dd/MM/yyyy")</dd>
                </dl>
            </div>
        </div>
    </div>
    <div class="form-steps">
        <div class="step">
            <button id="printDisposalSuccess"
                    type="button"
                    name="action"
                    value="printDisposalSuccess"
                    class="button js-only print-button">
                @Messages("change_keeper_success.buttonnavprint")
            </button>
        </div>

        <div class="step">
            @form(action = controllers.routes.ChangeKeeperSuccess.finish()) {
            @csrfTokenHiddenField()
            @surveyUrl match {
            case Some(url) => {
            <button id="@FinishId"
                    type="submit"
                    onclick="window.open('@url', '_blank');"
                    name="action"
                    class="button button-new-disposal button-secondary">
                @Messages("change_keeper_success.finish")
            </button>
            }
            case None => {
            <button id="@FinishId"
                    type="submit"
                    name="action"
                    class="button button-new-disposal button-secondary">
                @Messages("change_keeper_success.finish")
            </button>
            }
            }
            }
        </div>
    </div>
</div>
}
